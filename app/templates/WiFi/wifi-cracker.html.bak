<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', path='/css/styles.css') }}">
    <title>Wi-Fi Password Cracker - HackMaster Pi</title>
    <meta name="theme-color" content="#0f0f17">
</head>
<body>
    <div class="container">
        <div class="header-container">
            <a href="/" class="back-button">‚Üê BACK</a>
            <h1>Wi-Fi Password Cracker</h1>
        </div>
        
        <div class="info-guide">
            <h3>Wi-Fi Password Cracking Tool</h3>
            <p>This tool attempts to crack Wi-Fi passwords using dictionary attacks and handshake capture techniques. Follow these steps:</p>
            <ol>
                <li>Create a Wi-Fi monitoring interface</li>
                <li>Scan and select a target Wi-Fi network</li>
                <li>Start listening to capture handshake packets</li>
                <li>Send deauthentication signals to force clients to reconnect</li>
                <li>Select a wordlist to execute the cracking process</li>
            </ol>
            <p><strong>Disclaimer:</strong> This tool is for educational and security research purposes only. Unauthorized access to networks is illegal.</p>
        </div>
        
        <!-- Progress Indicator -->
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar" style="width: 0%">0%</div>
        </div>
        
        <!-- Steps Display Area -->
        <div id="step-container">
            <!-- Step 1: Create Monitor Interface -->
            <div id="step1" class="info-section">
                <div class="info-section-title">
                    <h3>Step 1: Create Monitor Interface</h3>
                </div>
                <div class="settings-panel">
                    <p>Select a Wi-Fi interface and put it into monitor mode:</p>
                    <div class="form-group">
                        <label for="interface-select">Network Interface:</label>
                        <select id="interface-select">
                            <option value="wlan0">wlan0 (Built-in Adapter)</option>
                            <option value="wlan1">wlan1 (External Adapter)</option>
                        </select>
                    </div>
                    <div class="status" id="monitor-status">Ready to start monitor mode</div>
                    <button id="create-monitor-btn" class="start-btn">START MONITOR MODE</button>
                </div>
            </div>
            
            <!-- Step 2: Scan Wi-Fi -->
            <div id="step2" class="info-section" style="display:none">
                <div class="info-section-title">
                    <h3>Step 2: Scan Wi-Fi Networks</h3>
                </div>
                <div class="settings-panel">
                    <p>Use the monitor interface to scan for nearby Wi-Fi networks:</p>
                    <div class="controls-container">
                        <button id="scan-networks-btn" class="start-btn">
                            SCAN NETWORKS
                            <span class="loading" id="scan-spinner" style="display: none;"></span>
                        </button>
                        <div class="counter" id="networks-count">0 NETWORKS</div>
                    </div>
                    
                    <div class="filter-container">
                        <input type="text" class="filter-input" id="network-filter" placeholder="Filter networks by SSID...">
                    </div>
                    
                    <div class="networks-container" id="networks-list">
                        <!-- Scanned networks will appear here -->
                    </div>
                </div>
            </div>
            
            <!-- Step 3: Capture Handshake -->
            <div id="step3" class="info-section" style="display:none">
                <div class="info-section-title">
                    <h3>Step 3: Capture Handshake</h3>
                </div>
                <div class="settings-panel">
                    <div class="selected-network" id="target-info">
                        <!-- Selected network info will appear here -->
                    </div>
                    
                    <p>Start listening for handshake packets on the target network:</p>
                    <div class="status" id="capture-status">Ready to start capturing</div>
                    
                    <div class="button-group">
                        <button id="start-capture-btn" class="start-btn">START CAPTURE</button>
                        <button id="stop-capture-btn" class="stop" style="display:none">STOP CAPTURE</button>
                    </div>
                    
                    <div class="capture-panel" style="display:none" id="capture-panel">
                        <div class="led-indicator"></div>
                        <span>Capturing handshake packets...</span>
                    </div>
                </div>
            </div>
            
            <!-- Step 4: Send Deauth Signals -->
            <div id="step4" class="info-section" style="display:none">
                <div class="info-section-title">
                    <h3>Step 4: Send Deauthentication Signals</h3>
                </div>
                <div class="settings-panel">
                    <p>Send deauthentication signals to force clients to reconnect and generate handshake packets:</p>
                    <div class="status" id="deauth-status">Ready to send deauth packets</div>
                    
                    <div class="form-group">
                        <label for="deauth-packets">Number of deauth packets:</label>
                        <input type="number" id="deauth-packets" value="5" min="1" max="20">
                    </div>
                    
                    <div class="checkbox-container">
                        <input type="checkbox" id="broadcast-deauth" checked>
                        <label for="broadcast-deauth">Broadcast to all connected devices</label>
                    </div>
                    
                    <button id="send-deauth-btn" class="start-btn">SEND DEAUTH SIGNALS</button>
                    
                    <div class="terminal-output" id="deauth-output">
                        Waiting for operation...
                    </div>
                </div>
            </div>
            
            <!-- Step 5: Verify Handshake Capture -->
            <div id="step5" class="info-section" style="display:none">
                <div class="info-section-title">
                    <h3>Step 5: Verify Handshake Capture</h3>
                </div>
                <div class="settings-panel">
                    <p>Check if a valid WPA handshake has been captured:</p>
                    <div class="status" id="handshake-status">Waiting for handshake verification...</div>
                    
                    <button id="verify-handshake-btn" class="start-btn">VERIFY HANDSHAKE</button>
                    
                    <div id="handshake-result" style="display:none" class="result-card">
                        <div class="result-title">
                            <h3>Handshake Analysis</h3>
                        </div>
                        <div class="terminal-output" id="handshake-output">
                            Analyzing...
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Step 6: Password Cracking -->
            <div id="step6" class="info-section" style="display:none">
                <div class="info-section-title">
                    <h3>Step 6: Password Cracking</h3>
                </div>
                <div class="settings-panel">
                    <p>Select a wordlist and start the password cracking process:</p>
                    
                    <div class="form-group">
                        <label for="wordlist-select">Select Wordlist:</label>
                        <select id="wordlist-select">
                            <option value="rockyou.txt">rockyou.txt (14 million entries)</option>
                            <option value="common-passwords.txt">common-passwords.txt (1 million entries)</option>
                            <option value="custom.txt">Custom wordlist (self-generated)</option>
                        </select>
                    </div>
                    
                    <div class="checkbox-container">
                        <input type="checkbox" id="advanced-mode">
                        <label for="advanced-mode">Enable Advanced Options</label>
                    </div>
                    
                    <div id="advanced-options" class="advanced-options" style="display:none">
                        <div class="form-group">
                            <label for="hash-mode">Hash Mode:</label>
                            <select id="hash-mode">
                                <option value="2500">WPA/WPA2</option>
                                <option value="16800">WPA-PMKID</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="attack-mode">Attack Mode:</label>
                            <select id="attack-mode">
                                <option value="0">Dictionary Attack</option>
                                <option value="1">Combination Attack</option>
                                <option value="3">Mask Attack</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="status" id="crack-status">Ready to start cracking</div>
                    
                    <button id="start-crack-btn" class="start-btn">START CRACKING</button>
                    <button id="stop-crack-btn" class="stop" style="display:none">STOP CRACKING</button>
                    
                    <div class="terminal-output" id="crack-output">
                        Waiting to start cracking process...
                    </div>
                    
                    <div id="result-container" style="display:none" class="result-card">
                        <div class="result-title">
                            <h3>Cracking Results</h3>
                        </div>
                        <div id="crack-result">
                            <!-- Results will appear here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Navigation Buttons -->
        <div class="button-group">
            <button id="prev-btn" class="back-button" style="display:none">PREVIOUS</button>
            <button id="next-btn" class="start-btn" style="display:none">NEXT</button>
        </div>
        
        <footer class="footer">
            <div class="disclaimer">
                <h3>DISCLAIMER</h3>
                <p>This tool is provided for educational and security research purposes only.</p>
                <p>The user assumes all responsibility for the use of this tool.</p>
                <p>Unauthorized access to computer systems and networks is illegal.</p>
                <p>DO NOT use this tool for any illegal, unauthorized, or malicious activities.</p>
            </div>
        </footer>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Step control
            let currentStep = 1;
            const totalSteps = 6;
            const progressBar = document.getElementById('progress-bar');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            // Step-related states
            let monitorMode = false;
            let captureRunning = false;
            let selectedNetwork = null;
            let handshakeCaptured = false;
            let crackRunning = false;
            
            // Update progress bar
            function updateProgress() {
                const progress = Math.round((currentStep - 1) / (totalSteps - 1) * 100);
                progressBar.style.width = progress + '%';
                progressBar.textContent = progress + '%';
            }
            
            // Show current step
            function showStep(step) {
                // Hide all steps
                for (let i = 1; i <= totalSteps; i++) {
                    document.getElementById(`step${i}`).style.display = 'none';
                }
                
                // Show current step
                document.getElementById(`step${step}`).style.display = 'block';
                
                // Update navigation buttons
                prevBtn.style.display = step > 1 ? 'inline-block' : 'none';
                nextBtn.style.display = step < totalSteps ? 'inline-block' : 'none';
                
                // Check if next button should be disabled
                updateNextButtonState();
                
                // Update progress bar
                currentStep = step;
                updateProgress();
            }
            
            // Update next button state
            function updateNextButtonState() {
                switch(currentStep) {
                    case 1:
                        nextBtn.disabled = !monitorMode;
                        break;
                    case 2:
                        nextBtn.disabled = !selectedNetwork;
                        break;
                    case 3:
                        nextBtn.disabled = captureRunning;
                        break;
                    case 4:
                        nextBtn.disabled = false; // Can proceed anytime
                        break;
                    case 5:
                        nextBtn.disabled = !handshakeCaptured;
                        break;
                    default:
                        nextBtn.disabled = false;
                }
            }
            
            // Initialize first step
            showStep(1);
            
            // Step navigation buttons
            prevBtn.addEventListener('click', function() {
                if (currentStep > 1) {
                    showStep(currentStep - 1);
                }
            });
            
            nextBtn.addEventListener('click', function() {
                if (currentStep < totalSteps) {
                    showStep(currentStep + 1);
                }
            });
            
            // ===== Step 1: Create Monitor Interface =====
            const createMonitorBtn = document.getElementById('create-monitor-btn');
            const monitorStatus = document.getElementById('monitor-status');
            
            createMonitorBtn.addEventListener('click', function() {
                monitorStatus.textContent = "Starting monitor mode...";
                monitorStatus.className = "status";
                
                // Simulate async operation
                setTimeout(function() {
                    monitorMode = true;
                    monitorStatus.textContent = "Monitor mode started! Interface is ready.";
                    monitorStatus.className = "status";
                    createMonitorBtn.disabled = true;
                    createMonitorBtn.textContent = "MONITOR MODE ACTIVE";
                    updateNextButtonState();
                }, 2000);
            });
            
            // ===== Step 2: Scan Wi-Fi =====
            const scanNetworksBtn = document.getElementById('scan-networks-btn');
            const scanSpinner = document.getElementById('scan-spinner');
            const networksList = document.getElementById('networks-list');
            const networksCount = document.getElementById('networks-count');
            const networkFilter = document.getElementById('network-filter');
            
            // Scan networks
            scanNetworksBtn.addEventListener('click', function() {
                scanSpinner.style.display = 'inline-block';
                scanNetworksBtn.disabled = true;
                networksList.innerHTML = '<div class="status">Scanning...</div>';
                
                // Simulate network scan
                setTimeout(function() {
                    // Generate mock network list
                    const networks = generateMockNetworks();
                    displayNetworks(networks);
                    
                    scanSpinner.style.display = 'none';
                    scanNetworksBtn.disabled = false;
                    networksCount.textContent = networks.length + " NETWORKS";
                }, 3000);
            });
            
            // Network filter
            networkFilter.addEventListener('input', function() {
                const filter = this.value.toLowerCase();
                const networkItems = document.querySelectorAll('.network-item');
                
                networkItems.forEach(item => {
                    const ssid = item.getAttribute('data-ssid').toLowerCase();
                    if (ssid.includes(filter)) {
                        item.style.display = 'block';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
            
            // Display network list
            function displayNetworks(networks) {
                networksList.innerHTML = '';
                
                if (networks.length === 0) {
                    networksList.innerHTML = '<div class="no-profiles">No networks found</div>';
                    return;
                }
                
                networks.forEach((network, index) => {
                    // Calculate signal strength percentage
                    const signalPercent = Math.min(100, Math.max(0, (network.signal_strength + 100) * 1.1));
                    
                    // Security color class
                    let securityClass = 'security-open';
                    if (network.security.includes('WPA3')) {
                        securityClass = 'security-wpa3';
                    } else if (network.security.includes('WPA2')) {
                        securityClass = 'security-wpa2';
                    } else if (network.security.includes('WPA')) {
                        securityClass = 'security-wpa';
                    } else if (network.security.includes('WEP')) {
                        securityClass = 'security-wep';
                    }
                    
                    // Generate network item
                    const networkItem = document.createElement('div');
                    networkItem.className = `network-item ${securityClass}`;
                    networkItem.setAttribute('data-ssid', network.ssid);
                    networkItem.setAttribute('data-bssid', network.bssid);
                    networkItem.setAttribute('data-channel', network.channel);
                    networkItem.setAttribute('data-security', network.security);
                    
                    networkItem.innerHTML = `
                        <div class="network-header">
                            <div class="network-name">
                                ${network.ssid}
                                <div class="detail-label">${network.security}</div>
                            </div>
                            <div class="network-signal">
                                ${network.signal_strength} dBm
                                <div class="signal-strength">
                                    <div class="signal-bar" style="width: ${signalPercent}%"></div>
                                </div>
                            </div>
                        </div>
                        <div class="network-details">
                            <div class="network-detail">
                                <span class="detail-label">Channel</span>
                                <span class="detail-value">${network.channel}</span>
                            </div>
                            <div class="network-detail">
                                <span class="detail-label">MAC</span>
                                <span class="detail-value">${network.bssid}</span>
                            </div>
                            <div class="network-detail">
                                <span class="detail-label">Last seen</span>
                                <span class="detail-value">${network.last_seen}</span>
                            </div>
                        </div>
                        <button class="start-btn select-network-btn">SELECT NETWORK</button>
                    `;
                    
                    networksList.appendChild(networkItem);
                });
                
                // Add network selection events
                document.querySelectorAll('.select-network-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const item = this.parentElement;
                        selectedNetwork = {
                            ssid: item.getAttribute('data-ssid'),
                            bssid: item.getAttribute('data-bssid'),
                            channel: item.getAttribute('data-channel'),
                            security: item.getAttribute('data-security')
                        };
                        
                        // Update UI to show selected network
                        document.querySelectorAll('.network-item').forEach(net => {
                            net.classList.remove('selected');
                        });
                        item.classList.add('selected');
                        
                        // Enable next button
                        updateNextButtonState();
                        
                        // Show selection confirmation
                        alert(`Target network selected: ${selectedNetwork.ssid}`);
                    });
                });
            }
            
            // Generate mock network data
            function generateMockNetworks() {
                const ssids = [
                    "HomeWiFi", "TP-LINK_58A92C", "ASUS_Router", "Netgear75", "HUAWEI-B535-95DA",
                    "ATT-WIFI-2854", "DIRECT-roku-724", "FRITZ!Box 7590", "Livebox-78FC", "eduroam",
                    "WiFi-Cafe", "GuestWiFi", "UPC Wi-Free", "XFINITY", "Public WiFi"
                ];
                
                const securities = [
                    "WPA2-PSK", "WPA2-PSK/WPA3-PSK", "WPA3-SAE", "WPA-PSK", "WEP", "Open"
                ];
                
                const securityWeights = [0.5, 0.2, 0.1, 0.15, 0.025, 0.025]; // Weight distribution
                
                // Generate random number of networks
                const numNetworks = Math.floor(Math.random() * 10) + 5; // 5-15 networks
                const networks = [];
                
                for (let i = 0; i < numNetworks; i++) {
                    // Randomly select SSID, possibly with numbers
                    let ssid = ssids[Math.floor(Math.random() * ssids.length)];
                    if (Math.random() > 0.7) {
                        ssid += "_" + Math.floor(Math.random() * 100);
                    }
                    
                    // Generate random MAC address
                    const mac = Array.from({length: 6}, () => 
                        Math.floor(Math.random() * 256).toString(16).padStart(2, '0')
                    ).join(':');
                    
                    // Select security type by weight
                    const rand = Math.random();
                    let securityIndex = 0;
                    let cumulativeWeight = 0;
                    
                    for (let j = 0; j < securityWeights.length; j++) {
                        cumulativeWeight += securityWeights[j];
                        if (rand <= cumulativeWeight) {
                            securityIndex = j;
                            break;
                        }
                    }
                    
                    // Add network
                    networks.push({
                        ssid: ssid,
                        bssid: mac.toUpperCase(),
                        signal_strength: -1 * (Math.floor(Math.random() * 60) + 30), // -30 to -90 dBm
                        security: securities[securityIndex],
                        channel: Math.floor(Math.random() * 13) + 1, // Channels 1-13
                        last_seen: "Just now"
                    });
                }
                
                // Sort by signal strength
                return networks.sort((a, b) => b.signal_strength - a.signal_strength);
            }
            
            // ===== Step 3: Capture Handshake =====
            const targetInfo = document.getElementById('target-info');
            const captureStatus = document.getElementById('capture-status');
            const startCaptureBtn = document.getElementById('start-capture-btn');
            const stopCaptureBtn = document.getElementById('stop-capture-btn');
            const capturePanel = document.getElementById('capture-panel');
            
            // Display selected network info
            function updateTargetInfo() {
                if (selectedNetwork) {
                    targetInfo.innerHTML = `
                        <div class="profile-item">
                            <div class="profile-details">
                                <div class="profile-name">${selectedNetwork.ssid}</div>
                                <div class="profile-info">
                                    <span class="profile-label">MAC Address:</span>
                                    <span class="profile-value">${selectedNetwork.bssid}</span>
                                </div>
                                <div class="profile-info">
                                    <span class="profile-label">Channel:</span>
                                    <span class="profile-value">${selectedNetwork.channel}</span>
                                </div>
                                <div class="profile-info">
                                    <span class="profile-label">Security:</span>
                                    <span class="profile-value">${selectedNetwork.security}</span>
                                </div>
                            </div>
                        </div>
                    `;
                }
            }
            
            // Update target info when entering step 3
            document.getElementById('next-btn').addEventListener('click', function() {
                if (currentStep === 2 && selectedNetwork) {
                    updateTargetInfo();
                }
            });
            
            // Start capture
            startCaptureBtn.addEventListener('click', function() {
                captureRunning = true;
                captureStatus.textContent = "Listening to target network...";
                captureStatus.className = "status";
                startCaptureBtn.style.display = 'none';
                stopCaptureBtn.style.display = 'inline-block';
                capturePanel.style.display = 'flex';
                capturePanel.querySelector('.led-indicator').classList.add('led-recording');
                updateNextButtonState();
            });
            
            // Stop capture
            stopCaptureBtn.addEventListener('click', function() {
                captureRunning = false;
                captureStatus.textContent = "Capture stopped. Handshake file saved.";
                captureStatus.className = "status";
                startCaptureBtn.style.display = 'inline-block';
                stopCaptureBtn.style.display = 'none';
                capturePanel.style.display = 'none';
                updateNextButtonState();
            });
            
            // ===== Step 4: Send Deauth Signals =====
            const deauthStatus = document.getElementById('deauth-status');
            const sendDeauthBtn = document.getElementById('send-deauth-btn');
            const deauthOutput = document.getElementById('deauth-output');
            
            sendDeauthBtn.addEventListener('click', function() {
                const packets = document.getElementById('deauth-packets').value;
                const broadcast = document.getElementById('broadcast-deauth').checked;
                
                deauthStatus.textContent = "Sending deauthentication signals...";
                deauthStatus.className = "status";
                sendDeauthBtn.disabled = true;
                
                // Update terminal output
                deauthOutput.innerHTML = "Preparing to send deauth packets...\n";
                
                // Simulate deauth process
                simulateDeauth(packets, broadcast);
            });
            
            // Simulate deauth process
            function simulateDeauth(packets, broadcast) {
                let count = 0;
                const target = selectedNetwork.bssid;
                const interval = setInterval(function() {
                    if (count >= packets) {
                        clearInterval(interval);
                        deauthStatus.textContent = "Deauthentication signals completed!";
                        deauthStatus.className = "status";
                        sendDeauthBtn.disabled = false;
                        return;
                    }
                    
                    count++;
                    const now = new Date().toLocaleTimeString();
                    
                    if (broadcast) {
                        deauthOutput.innerHTML += `[${now}] Sending broadcast deauth packet (${count}/${packets}) to ${target}\n`;
                    } else {
                        deauthOutput.innerHTML += `[${now}] Sending directed deauth packet (${count}/${packets}) to ${target}\n`;
                    }
                    
                    // Auto-scroll to bottom
                    deauthOutput.scrollTop = deauthOutput.scrollHeight;
                }, 1000);
            }
            
            // ===== Step 5: Verify Handshake Capture =====
            const handshakeStatus = document.getElementById('handshake-status');
            const verifyHandshakeBtn = document.getElementById('verify-handshake-btn');
            const handshakeResult = document.getElementById('handshake-result');
            const handshakeOutput = document.getElementById('handshake-output');
            
            verifyHandshakeBtn.addEventListener('click', function() {
                handshakeStatus.textContent = "Verifying handshake...";
                handshakeStatus.className = "status";
                verifyHandshakeBtn.disabled = true;
                handshakeResult.style.display = 'block';
                
                // Simulate verification process
                setTimeout(function() {
                    // 80% chance of success
                    handshakeCaptured = Math.random() < 0.8;
                    
                    if (handshakeCaptured) {
                        handshakeStatus.textContent = "Success! Valid WPA handshake found";
                        handshakeStatus.className = "status";
                        handshakeOutput.innerHTML = `
                            [+] Reading capture file: capture_${selectedNetwork.ssid.replace(/ /g, '_')}.cap
                            [+] Analyzing packet contents...
                            [+] WPA handshake found (message pairs 1-4)
                            [+] Handshake integrity verified
                            [+] SSID: ${selectedNetwork.ssid}
                            [+] MAC: ${selectedNetwork.bssid}
                            [+] Ready for password cracking
                        `;
                    } else {
                        handshakeStatus.textContent = "No complete handshake found. Try capturing again.";
                        handshakeStatus.className = "status error";
                        handshakeOutput.innerHTML = `
                            [+] Reading capture file: capture_${selectedNetwork.ssid.replace(/ /g, '_')}.cap
                            [+] Analyzing packet contents...
                            [-] No complete WPA handshake found
                            [!] Suggestion: Go back and try sending more deauth signals
                        `;
                    }
                    
                    verifyHandshakeBtn.disabled = false;
                    updateNextButtonState();
                }, 3000);
            });
            
            // ===== Step 6: Password Cracking =====
            const advancedModeCheckbox = document.getElementById('advanced-mode');
            const advancedOptions = document.getElementById('advanced-options');
            const crackStatus = document.getElementById('crack-status');
            const startCrackBtn = document.getElementById('start-crack-btn');
            const stopCrackBtn = document.getElementById('stop-crack-btn');
            const crackOutput = document.getElementById('crack-output');
            const resultContainer = document.getElementById('result-container');
            const crackResult = document.getElementById('crack-result');
            
            // Advanced options toggle
            advancedModeCheckbox.addEventListener('change', function() {
                advancedOptions.style.display = this.checked ? 'block' : 'none';
            });
            
            // Start cracking
            startCrackBtn.addEventListener('click', function() {
                const wordlist = document.getElementById('wordlist-select').value;
                
                crackRunning = true;
                crackStatus.textContent = "Password cracking in progress...";
                crackStatus.className = "status";
                startCrackBtn.style.display = 'none';
                stopCrackBtn.style.display = 'inline-block';
                crackOutput.innerHTML = "Initializing cracking engine...\n";
                resultContainer.style.display = 'none';
                
                // Simulate cracking process
                simulateCracking(wordlist);
            });
            
            // Stop cracking
            stopCrackBtn.addEventListener('click', function() {
                crackRunning = false;
                crackStatus.textContent = "Cracking process aborted";
                crackStatus.className = "status";
                startCrackBtn.style.display = 'inline-block';
                stopCrackBtn.style.display = 'none';
                crackOutput.innerHTML += "\n[!] User aborted cracking process\n";
            });
            
            // Simulate cracking process
            function simulateCracking(wordlist) {
                let seconds = 0;
                let testedKeys = 0;
                let speed = Math.floor(Math.random() * 2000) + 4000; // Keys per second
                let found = Math.random() < 0.6; // 60% chance of finding password
                let totalTime = found ? Math.floor(Math.random() * 60) + 20 : 120; // If found, 20-80s, else run for 120s
                let password = found ? generatePassword() : null;
                
                const interval = setInterval(function() {
                    if (!crackRunning || seconds >= totalTime) {
                        clearInterval(interval);
                        
                        // Display result
                        if (found && crackRunning) {
                            crackStatus.textContent = "Cracking successful! Password found";
                            crackStatus.className = "status";
                            
                            resultContainer.style.display = 'block';
                            crackResult.innerHTML = `
                                <div class="status">
                                    <h3>Password Found!</h3>
                                    <div class="profile-info">
                                        <span class="profile-label">SSID:</span>
                                        <span class="profile-value">${selectedNetwork.ssid}</span>
                                    </div>
                                    <div class="profile-info">
                                        <span class="profile-label">Password:</span>
                                        <span class="profile-value">${password}</span>
                                    </div>
                                    <div class="profile-info">
                                        <span class="profile-label">Time:</span>
                                        <span class="profile-value">${seconds} seconds</span>
                                    </div>
                                    <div class="profile-info">
                                        <span class="profile-label">Keys tried:</span>
                                        <span class="profile-value">${testedKeys.toLocaleString()}</span>
                                    </div>
                                </div>
                            `;
                        } else if (crackRunning) {
                            crackStatus.textContent = "Cracking failed: Password not found in wordlist";
                            crackStatus.className = "status error";
                        }
                        
                        startCrackBtn.style.display = 'inline-block';
                        stopCrackBtn.style.display = 'none';
                        crackRunning = false;
                        return;
                    }
                    
                    seconds++;
                    testedKeys += speed;
                    
                    if (seconds % 5 === 0 || seconds === 1) {
                        crackOutput.innerHTML += `[${seconds}s] Speed: ${speed.toLocaleString()} keys/s, Tried: ${testedKeys.toLocaleString()}\n`;
                        crackOutput.scrollTop = crackOutput.scrollHeight;
                        
                        // Random speed fluctuation
                        speed = Math.floor(speed * (0.9 + Math.random() * 0.2));
                    }
                    
                    // If about to find password, give hint
                    if (found && seconds === totalTime - 2) {
                        crackOutput.innerHTML += `[${seconds}s] Potential match found! Verifying...\n`;
                        crackOutput.scrollTop = crackOutput.scrollHeight;
                    }
                }, 1000);
            }
            
            // Generate mock password
            function generatePassword() {
                const commonPasswords = [
                    "password123", "admin123", "welcome1", "123456789", "qwerty123", 
                    "football", "iloveyou", "sunshine", "princess", "dragon123",
                    "abc12345", "letmein", "monkey123", "1q2w3e4r", "trustno1"
                ];
                
                return commonPasswords[Math.floor(Math.random() * commonPasswords.length)];
            }
        });
    </script>
</body>
</html>